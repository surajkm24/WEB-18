<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="navbar.css">
    <style>
        #container{
            margin-top:15px;
          display:grid;
          grid-template-columns:repeat(4,23%);
          width:100%;
          gap:20px;
          font-family:sans-serif;
        }
        #container>div{
          box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;
          border-radius:10px;
          padding:0px 0px 10px 0px;
        }
        #container>div>div{
          display:flex;
          justify-content: space-between;
          padding:0px 15px;
          margin-top:-40px;
        }
        #container>div>div>p+p{
          text-decoration: line-through;
          color:grey;
        }
        img{
          width:100%;
          border-radius:10px
        }
        button{
          margin:0px 15px;
          border-radius:4px;
          font-size:17px;
          border:3px blue solid;
          background-color: whitesmoke;
          color:blue;
  
        }
        button:hover{
          cursor:pointer;
          opacity:0.8;
        }
        h4{
          width:auto;
          padding:15px;
          margin-top:-15px;
          overflow:hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }
        #cart{
            display:flex;
            justify-content: space-between;
            align-items: center;
        }
       #cart>div{
         display:flex;
         gap:10px;
         font-size:17px;
         font-family:sans-serif;
         align-items: center;
       }
       #promo{
         height:24px;
         border-radius:4px;
         border:4px solid rgba(0, 34, 255, 0.561);
         font-size:17px;
         width:160px;
         padding-left:10px;
       }
       #prBtn{
         height:30px;
       }
       #prBtn:hover{
         opacity:0.8;
         cursor:pointer;
       }
       #cartItems,#totalPrice{
         border: 4px solid rgba(36, 36, 50, 0.538);
         border-radius:4px;
       }
      </style>
</head>
<body>
    <div id="nav">
        <p>Rebook</p>
        <div>
        <p onclick="mensPage()">Men</p>
        <p onclick="womensPage()">Women</p>
        <p onclick="loginPage()">Login</p>
        <p onclick="signupPage()">Signup</p>
    </div>
    </div>
    <div id="cart">
    <h2>Cart</h2>
    <div>
      <input type="text" id="promo" placeholder="Promo Code"/>
      <button id="prBtn">Apply Promo</button>
        <p id="cartItems"></p>
        <p id="totalPrice"></p>
    </div>
   </div>
    <div id="container"></div>
</body>
</html>
<script>
    var cartArr = JSON.parse(localStorage.getItem("cartData"));
    var price = 0;

    cartArr.forEach(function(elem,index){
    var card = document.createElement("div");

    var image = document.createElement("img");
    image.setAttribute("src",elem.image_url);

    var dname = document.createElement("h4");
    dname.innerText = elem.name;

    var dprice = document.createElement("p");
    dprice.innerText = elem.price;

    var sdprice = document.createElement("p");
    sdprice.innerText = elem.strikedoffprice;

    var card1 = document.createElement("div");
    card1.append(dprice,sdprice);
    
    price = price+(elem.price)
    var btn = document.createElement("button");
    btn.innerText = "Remove from Cart";
    btn.addEventListener("click",function(){
      removeFromCart(elem,index);
    })

    card.append(image,dname,card1,btn);
    document.querySelector("#container").append(card);
    document.querySelector("#cartItems").innerText ="Total items: " + cartArr.length;
    document.querySelector("#totalPrice").innerText ="Price: "+"Rs"+" "+price;

    function removeFromCart(elem,index) {
       event.target.parentNode.remove();
       cartArr.splice(index,1);
       price = price-(elem.price)
       document.querySelector("#cartItems").innerText = "Total items: "+cartArr.length;
       document.querySelector("#totalPrice").innerText = "Price"+"Rs"+" "+price;;
       localStorage.setItem("cartData",JSON.stringify(cartArr))
   }

  })
  
  document.querySelector("#prBtn").addEventListener("click",applyPromo) 
  function applyPromo(){
    var code = document.querySelector("#promo").value
    if(code==="masai30"){
    price = price*(70/100);
    document.querySelector("#totalPrice").innerText ="Price: "+"Rs"+" "+price;
  }

  }
  
  function signupPage() {
        window.location.href = "signup.html"
    }
    function loginPage() {
        window.location.href = "login.html"
    }
    function mensPage() {
        var token = localStorage.getItem("token");
        if (token) {
            window.location.href = "mens.html"
        }
        else {
            alert("Please login to start using our services!");
            window.location.href = "login.html"
        }
    }
    function womensPage() {
        var token = localStorage.getItem("token");
        if (token) {
            window.location.href = "womens.html"
        }
        else {
            alert("Please login to start using our services!");
            window.location.href = "login.html"
        }
    }
  
</script>